<div id="squirrel-chat-ui" class="text-left d-flex flex-column h-100">
    <div id="scu-header" class="bg-light d-flex justify-content-between">
        <div class="scu-info px-3 py-2 flex-grow-1">
            <img [src]="profileImageSource" class="float-left mr-3 mt-1" id="scu-avatar">
            <h3 class="mb-0">Max Mustermann</h3>
            <span>Zuletzt online: heute um 18:59 Uhr</span>
        </div>
        <div class="scu-actions d-flex align-items-center flex-column">
            <div class="my-auto">
                <button class="btn text-primary" (click)="videoCallClicked.emit()"><i class="fas fa-video"></i></button>
                <button class="btn text-primary" (click)="audioCallClicked.emit()"><i class="fas fa-phone-alt"></i></button>
                <div class="dropdown d-inline" *ngIf="menuItems.length > 0" (blur)="showMenuDropDown = false">
                    <button class="btn text-primary" (click)="showMenuDropDown = !showMenuDropDown"><i class="fas fa-ellipsis-v"></i></button>
                    <div class="dropdown-menu dropdown-menu-right" [class.show]="showMenuDropDown">
                        <ng-container *ngFor="let menuItem of menuItems">
                            <button (click)="menuItemClicked.emit(menuItem)" (blur)="showMenuDropDown = false" class="dropdown-item">{{menuItem}}</button>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="scu-body" class="flex-grow-1 p-4 overflow-auto" #scrollMe (scroll)="onScroll()">
        <div class="" *ngFor="let message of messages; let idx = index">
            <div class="scu-message-holder d-flex my-1" [class.justify-content-end]="message.fromMe">
                <div class="scu-message px-2 py-1 position-relative" [class.scu-from-me]="message.fromMe">
                    <div class="scu-message-actions bg-white position-absolute p-1 pointer-event scu-shadow">
                        <button class="btn py-0 px-1" *ngFor="let reaction of reactions"><ngx-emoji [emoji]="reaction" size="24"></ngx-emoji></button>
                        <span class="scu-divider mx-1"></span>
                        <button (focus)="message.showDropDown = true" (blur)="message.showDropDown = false" class="btn"><i class="fas fa-ellipsis-h pb-2 "></i></button>
                        <div class="dropdown-menu dropdown-menu-right scu-dropdown" [class.show]="message.showDropDown">
                            <button ngbdropdownitem="" class="dropdown-item">Action - 1</button>
                            <button ngbdropdownitem="" class="dropdown-item">Another Action</button>
                            <button ngbdropdownitem="" class="dropdown-item">Something else is here</button>
                        </div>
                    </div>
                    <span class="scu-user" *ngIf="!message.fromMe && !isContinuing(message)"><b>{{message.sender.name}}</b></span>
                    <span class="d-block">{{message.text}}</span>
                    <div class="text-right text-muted">
                        <small>{{message.date | date:'shortTime'}} <i *ngIf="message.fromMe" [class]="getStatusIconClass(message)"></i></small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="scu-footer" class="bg-light p-1 d-flex p-relative">
        <emoji-mart id="scu-emoji-picker" [class.d-none]="!showEmojiPicker" (emojiSelect)="emojiSelected($event)"></emoji-mart>
        <div id="scu-attachments" class="scu-card p-4 mx-4 bg-white" [class.d-none]="!showAttachmentsCard">
            <table class="text-center">
                <tr>
                    <td class="p-2">
                        <button class="btn text-primary">
                            <i class="fas fa-2x fa-upload"></i><br>
                            Hochladen
                        </button>
                    </td>
                    <td class="p-2">
                        <button class="btn text-primary">
                            <i class="fas fa-2x fa-folder-open"></i><br>
                            Ausw√§hlen
                        </button>
                    </td>
                    <td class="p-2">
                        <button class="btn text-primary">
                            <i class="fas fa-2x fa-smile"></i><br>
                            Emoji
                        </button>
                    </td>
                </tr>
                <tr>
                    <td class="p-2">
                        <button class="btn text-primary">
                            <i class="fas fa-2x fa-map-marker-alt"></i><br>
                            Standort
                        </button>
                    </td>
                    <td class="p-2">
                        <button class="btn text-primary">
                            <i class="fas fa-2x fa-video"></i><br>
                            Video
                        </button>
                    </td>
                    <td class="p-2">
                        <button class="btn text-primary">
                            <i class="fas fa-2x fa-microphone"></i><br>
                            Audio
                        </button>
                    </td>
                </tr>
            </table>
        </div>
        <div class="scu-actions">
            <button class="btn text-dark" (click)="toggleEmojiPicker()"><i class="fas fa-laugh"></i></button>
            <button class="btn text-dark" (click)="toggleAttachmentsCard()"><i class="fas fa-paperclip"></i></button>
            <button class="btn text-dark"><i class="fas fa-edit"></i></button>
        </div>
        <div class="scu-input flex-grow-1">
            <input type="text" class="form-control w-100" [(ngModel)]="message" #messageInput>
        </div>
        <div class="scu-actions">
            <button class="btn text-dark" (click)="sendMessage()" [disabled]="getTrimmedMessage() == '' ? 'disabled' : ''"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>